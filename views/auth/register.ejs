<!DOCTYPE html>
<html>
<head>
  <title>Đăng ký Customer</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-5" onload="prefill()">
  <h2>Đăng ký Khách đặt phòng</h2>

  <% if (typeof error !== 'undefined') { %>
    <div class="alert alert-danger"><%= error %></div>
  <% } %>

  <form method="POST" action="/register" onsubmit="return checkConfirm()">
    <div class="mb-3">
      <label for="email" class="form-label">Email (dùng làm tên đăng nhập)</label>
      <input type="email" class="form-control" id="email" name="email"
             value="<%= (form && form.email) || '' %>" required>
    </div>

    <div class="mb-3">
      <label for="phoneNumber" class="form-label">Số điện thoại</label>
      <input type="tel" class="form-control" id="phoneNumber" name="phoneNumber"
             pattern="^[0-9]{9,12}$" title="Chỉ gồm 9-12 chữ số"
             value="<%= (form && form.phoneNumber) || '' %>" required>
    </div>

    <div class="mb-3">
      <label for="idCard" class="form-label">CMND/CCCD</label>
      <input type="text" class="form-control" id="idCard" name="idCard"
             pattern="^[0-9]{9,12}$" title="Chỉ gồm 9-12 chữ số"
             value="<%= (form && form.idCard) || '' %>" required>
    </div>

    <div class="mb-3">
      <label for="password" class="form-label">Mật khẩu</label>
      <input type="password" class="form-control" id="password" name="password"
             minlength="6" required>
    </div>

    <div class="mb-3">
      <label for="confirmPassword" class="form-label">Xác nhận mật khẩu</label>
      <input type="password" class="form-control" id="confirmPassword" name="confirmPassword"
             minlength="6" required>
      <div class="form-text" id="confirmHelp" style="display:none;color:#dc3545">
        Mật khẩu xác nhận không khớp.
      </div>
    </div>

    <button type="submit" class="btn btn-success">Đăng ký</button>
    <a href="/customer/login" class="btn btn-link ms-2">Đã có tài khoản? Đăng nhập</a>
  </form>

  <script>
    function checkConfirm() {
      const p1 = document.getElementById('password').value;
      const p2 = document.getElementById('confirmPassword').value;
      const help = document.getElementById('confirmHelp');
      if (p1 !== p2) {
        help.style.display = 'block';
        return false;
      }
      help.style.display = 'none';
      return true;
    }
    // Giữ lại dữ liệu người dùng nhập khi có lỗi server
    function prefill() {
      // Không cần JS nếu dùng EJS value= như trên, nhưng để đây nếu sau muốn mở rộng
    }
  </script>
</body>
</html>
