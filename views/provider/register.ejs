<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Đăng ký Nhà Cung Cấp</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f8f9fa;
      font-family: 'Segoe UI', sans-serif;
    }

    .register-box {
      max-width: 900px;
      background: #fff;
      margin: 80px auto;
      padding: 40px 50px;
      border-radius: 15px;
      border: 1px solid #ddd;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
    }

    h1 {
      text-align: center;
      font-weight: 600;
      margin-bottom: 50px;
      margin-left: 0px;
    }

    label {
      font-weight: 600;
      margin-bottom: 5px;
    }

    input::placeholder {
      color: #b5b5b5;
      font-size: 0.95rem;
    }

    .btn-register {
      width: 100%;
      background-color: #000;
      border: none;
      padding: 10px;
      font-weight: 600;
      color: #fff;
      border-radius: 5px;
      transition: all 0.3s ease;
    }

    .btn-register:hover {
      background-color: #333;
    }

    .alert {
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="register-box">
    <h1>Đăng ký</h1>

    <% if (error) { %>
      <div class="alert alert-danger"><%= error %></div>
    <% } %>
    <% if (success) { %>
      <div class="alert alert-success"><%= success %></div>
    <% } %>

    <form method="POST" action="/provider/register">
      <div class="row">
        <!-- Cột bên trái -->
         <div class="mb-3">
        <label>Tên nhà cung cấp:</label>
        <input type="text" name="providerName" class="form-control" placeholder="Nhập tên nhà cung cấp" required>
        </div>
        <div class="col-md-6">
          <div class="mb-3">
            <label>Email:</label>
            <input type="email" name="email" class="form-control" placeholder="abc@gmail.com" required>
          </div>

          <div class="mb-3">
            <label>Số điện thoại:</label>
            <input type="text" name="phoneNumber" class="form-control" placeholder="10 chữ số và bắt đầu bằng số 0" required>
          </div>

          <div class="mb-3">
            <label>Số CCCD:</label>
            <input type="text" name="cccd" class="form-control" placeholder="12 chữ số" required>
          </div>
        </div>

        <!-- Cột bên phải -->
        <div class="col-md-6">
          <div class="mb-3">
            <label>Mật khẩu:</label>
            <input type="password" name="password" class="form-control" placeholder="Tối thiểu 8 ký tự" required>
          </div>

          <div class="mb-3">
            <label>Nhập lại mật khẩu:</label>
            <input type="password" name="confirmPassword" class="form-control" placeholder="Nhập mật khẩu trùng với mật khẩu" required>
          </div>

          <div class="mb-3">
            <label>Mã số thuế:</label>
            <input type="text" name="taxCode" class="form-control" placeholder="10 chữ số (DN), 13 chữ số (CN)">
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-md-12 mt-3">
          <button type="submit" class="btn-register">Đăng ký</button>
        </div>
      </div>
    </form>
  </div>
</body>
</html>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const emailInput = document.querySelector("input[name='email']");
  const phoneInput = document.querySelector("input[name='phoneNumber']");
  const cccdInput = document.querySelector("input[name='cccd']");
  const passwordInput = document.querySelector("input[name='password']");
  const confirmPasswordInput = document.querySelector("input[name='confirmPassword']");
  const taxCodeInput = document.querySelector("input[name='taxCode']");
  const form = document.querySelector("form");

  // Regex giống middleware server
  const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
  const phoneRegex = /^0\d{9}$/;
  const cccdRegex = /^\d{12}$/;
  const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$/;

  function showError(input, message) {
    let error = input.parentElement.querySelector(".text-danger");
    if (!error) {
      error = document.createElement("small");
      error.classList.add("text-danger");
      input.parentElement.appendChild(error);
    }
    error.textContent = message;
  }

  function clearError(input) {
    const error = input.parentElement.querySelector(".text-danger");
    if (error) error.remove();
  }

  // Kiểm tra email
  emailInput.addEventListener("input", () => {
    clearError(emailInput);
    if (emailInput.value && !emailRegex.test(emailInput.value)) {
      showError(emailInput, "Email không hợp lệ (vd: abc12@gmail.com)");
    }
  });

  // Kiểm tra số điện thoại
  phoneInput.addEventListener("input", () => {
    clearError(phoneInput);
    if (phoneInput.value && !phoneRegex.test(phoneInput.value)) {
      showError(phoneInput, "Số điện thoại phải có 10 chữ số và bắt đầu bằng 0");
    }
  });

  // Kiểm tra CCCD
  cccdInput.addEventListener("input", () => {
    clearError(cccdInput);
    if (cccdInput.value && !cccdRegex.test(cccdInput.value)) {
      showError(cccdInput, "CCCD phải gồm 12 chữ số");
    }
  });

  // Kiểm tra mật khẩu
  passwordInput.addEventListener("input", () => {
    clearError(passwordInput);
    if (passwordInput.value && !passwordRegex.test(passwordInput.value)) {
      showError(passwordInput, "Mật khẩu phải ≥ 8 ký tự, gồm chữ hoa, chữ thường và số");
    }
  });

  // Kiểm tra nhập lại mật khẩu
  confirmPasswordInput.addEventListener("input", () => {
    clearError(confirmPasswordInput);
    if (confirmPasswordInput.value && confirmPasswordInput.value !== passwordInput.value) {
      showError(confirmPasswordInput, "Mật khẩu nhập lại không khớp");
    }
  });

  // Kiểm tra mã số thuế (nếu nhập)
  taxCodeInput.addEventListener("input", () => {
    clearError(taxCodeInput);
    if (taxCodeInput.value && !/^\d{10,13}$/.test(taxCodeInput.value)) {
      showError(taxCodeInput, "Mã số thuế phải gồm 10 hoặc 13 chữ số");
    }
  });

  // Ngăn form gửi nếu có lỗi
  form.addEventListener("submit", (e) => {
    const errors = document.querySelectorAll(".text-danger");
    if (errors.length > 0) {
      e.preventDefault();
      alert("Vui lòng kiểm tra lại thông tin trước khi đăng ký!");
    }
  });
});
</script>
