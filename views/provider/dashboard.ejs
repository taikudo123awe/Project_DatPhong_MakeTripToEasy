<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8" />
  <title>Trang qu·∫£n l√Ω nh√† cung c·∫•p</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>

<body class="container mt-4">
  <!-- <h2>Xin ch√†o <%= provider.username %>!</h2>
  <div class="mb-4">
    <a href="/provider/add-room" class="btn btn-success">+ Th√™m ph√≤ng m·ªõi</a>
    <a href="/provider/edit-profile" class="btn btn-primary ms-2">Ch·ªânh s·ª≠a th√¥ng tin</a>
    <a href="/provider/reviews" class="btn btn-info ms-2">Xem ƒë√°nh gi√°</a>
    <a href="/provider/bookings" class="btn btn-warning ms-2">Qu·∫£n l√Ω ƒë∆°n</a>
    <a href="/provider/report" class="btn btn-warning ms-2">Xem b√°o c√°o</a>
    <a href="/logout" class="btn btn-outline-danger ms-2">ƒêƒÉng xu·∫•t</a>
  </div> -->

  <%- include('../partials/header-provider') %>
    <!-- üîî Th√¥ng b√°o sau khi x√≥a ho·∫∑c s·ª≠a -->
    <% if (typeof success !=="undefined" && success) { %>
      <div class="alert alert-success alert-dismissible fade show" role="alert">
        ‚úÖ <%= success %>
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
      </div>
      <% } %>
        <% if (typeof error !=="undefined" && error) { %>
          <div class="alert alert-danger alert-dismissible fade show" role="alert">
            ‚ö†Ô∏è <%= error %>
              <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>
          <% } %>

            <h4>üìã Danh s√°ch ph√≤ng ƒë√£ ƒëƒÉng:</h4>

            <% if (providerRooms && providerRooms.length> 0) { %>
              <table class="table table-bordered mt-3 align-middle text-center">
                <thead class="table-light">
                  <tr>
                    <th>#</th>
                    <th>T√™n ph√≤ng</th>
                    <th>Gi√° (VND)</th>
                    <th>Tr·∫°ng th√°i duy·ªát</th>
                    <th>Ng√†y ƒëƒÉng</th>
                    <th>Thao t√°c</th>
                  </tr>
                </thead>
                <tbody>
                  <% providerRooms.forEach((room, index)=> { %>
                    <tr>
                      <td>
                        <%= index + 1 %>
                      </td>
                      <td>
                        <%= room.roomName %>
                      </td>
                      <td>
                        <%= room.price.toLocaleString() %>
                      </td>
                      <td>
                        <%= room.approvalStatus %>
                      </td>
                      <td>
                        <%= new Date(room.postedAt).toLocaleDateString('vi-VN') %>
                      </td>

                      <!-- üß© C·ªôt h√†nh ƒë·ªông -->
                      <td>
                        <a href="/provider/edit-room/<%= room.roomId %>" class="btn btn-warning btn-sm me-2">
                          üñãÔ∏è S·ª≠a
                        </a>

                        <form action="/provider/delete-room/<%= room.roomId %>" method="POST" class="delete-room-form"
                          data-room-name="<%= room.roomName %>" style="display: inline">
                          <button type="submit" class="btn btn-danger btn-sm">
                            ‚ùå X√≥a
                          </button>
                        </form>
                      </td>
                    </tr>
                    <% }) %>
                </tbody>
              </table>
              <% } else { %>
                <p class="text-muted mt-3">B·∫°n ch∆∞a ƒëƒÉng ph√≤ng n√†o.</p>
                <% } %>

                  <script>
                    // ‚úÖ X√°c nh·∫≠n khi x√≥a ph√≤ng
                    document.querySelectorAll(".delete-room-form").forEach((form) => {
                      form.addEventListener("submit", function (e) {
                        const roomName = this.getAttribute("data-room-name") || "ph√≤ng";
                        const confirmDelete = confirm(
                          `‚ö†Ô∏è B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a "${roomName}" kh√¥ng?\nH√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c!`
                        );
                        if (!confirmDelete) e.preventDefault();
                      });
                    });
                  </script>

                  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>